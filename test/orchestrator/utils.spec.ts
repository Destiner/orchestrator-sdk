import { Address } from "viem"
import { ChainExecution } from "../../src/types"
import { updateTargetFillPayload } from "../../src/utils"


describe('Utils', () => {
    describe('bundles', () => {
        it('should update target fill payload correctly', () => {
            const targetFillPayload: ChainExecution = {
                to: "0xea34faadb44f6078c24cb82d6be3185a262ddee6",
                value: 0n,
                data: "0x17d905e40000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008c000000000000000000000000000000000000000000000000000000000000009000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000007c00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001200000000000000000000000008b7f8f3a00cde57c9c118c3edeadac5275c945b200000000000000000000000082af49447d8a07e3bd95bd0d56f35241523fbab1000000000000000000000000000000000000000000000000000000000000a4b1fc256cfffc9b03ca0a58b6d20f4d36396f4bf0d6c53cf5503140e51caa92eb5d0000000000000000000000000000000000000000000000000000000000000001304d84c3d9a7be3b28c94531af88d065e77c8cc2239327c5edb3a432268e583100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000001304d84c3d9a7be3b28c94531833589fcd6edb6e08f4c7c32d4f71b54bda0291300000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000561010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000e6a74e08eff5df62efb601ec04eaf764471da7970000000000000000000000008b7f8f3a00cde57c9c118c3edeadac5275c945b2000000000000000000000000000000000000000000000000000000000000a4b1fc256cfffc9b03ca0a58b6d20f4d36396f4bf0d6c53cf5503140e51caa92eb5d0000000000000000000000000000000000000000000000000000000069a187311708497c3b281c373f4e5b08cceedcbfb1dc220749fb9bbc74d83d8189ff45fe00000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000260000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000004c0000000000000000000000000e6a74e08eff5df62efb601ec04eaf764471da79700000000000000000000000000000000000000000000000000000000000000c000000000000000000000000042000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000067c054290000000000000000000000000000000000000000000000000000000000000000c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a4700000000000000000000000000000000000000000000000000000000000000001304d84c3d9a7be3b28c94531833589fcd6edb6e08f4c7c32d4f71b54bda029130000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000d1da1f965a95642959f72d6aac7502f003c4cff400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000016427c777a9000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c05dd4ceae21111aef8333129c43ddac5129947a3d9fc6e04578e995d6d680ea150000000000000000000000000000000000000000000000000000000069a18731304d84c3d9a7be3b28c94531833589fcd6edb6e08f4c7c32d4f71b54bda029130000000000000000000000000000000000000000000000000000000000000003000000000000000000000000e6a74e08eff5df62efb601ec04eaf764471da797000000000000000000000000000000000000000000000000000000000000004126d48cc86c2f74484ba1dbeaa09bb148ccd2b830de70f2ad532350f6ffec1a462ebd264d3c6ce9476e4615739f4defae93d7d2e03419edaa52867e80160f85bf1c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000552483DA3A338895199E5e538530213157e931Bf0697e90c5de6a7b6312321bce8bf463a7a1aab87cca40e6672309b0af28906c2b35e7120838caa943a64c8826e32f7e22b4f64794f48194fd6f8f52852f78a1dcb1b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000414c77c629f6ce83f080adb322a474e874c29492075f2f1039ad46fe67a902f54d05c3b70d7e499ead6daa219154c48157f5257286628d2cbe8bfbbbdd8bda822d1c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000e59aaf21c4d9cf92d9ed4537f4404ba031f83b230000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000a4b1",
                chainId: 8453
            }

            const repaymentAddress: Address = "0x8b7f8f3a00cde57c9c118c3edeadac5275c945b2"
            const repaymentChainIds: number = 10
            const result = updateTargetFillPayload(targetFillPayload, repaymentAddress, repaymentChainIds)
            
            expect(result.to).toBe(targetFillPayload.to)
            expect(result.value).toBe(targetFillPayload.value)
            expect(result.chainId).toBe(targetFillPayload.chainId)
            expect(result.data).toBe("0x17d905e40000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008a000000000000000000000000000000000000000000000000000000000000008e00000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000007a00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000001000000000000000000000000008b7f8f3a00cde57c9c118c3edeadac5275c945b200000000000000000000000082af49447d8a07e3bd95bd0d56f35241523fbab1000000000000000000000000000000000000000000000000000000000000a4b10000000000000000000000000000000000000000000000000000000000000001304d84c3d9a7be3b28c94531af88d065e77c8cc2239327c5edb3a432268e583100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000001304d84c3d9a7be3b28c94531833589fcd6edb6e08f4c7c32d4f71b54bda0291300000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000561010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000e6a74e08eff5df62efb601ec04eaf764471da7970000000000000000000000008b7f8f3a00cde57c9c118c3edeadac5275c945b2000000000000000000000000000000000000000000000000000000000000a4b1fc256cfffc9b03ca0a58b6d20f4d36396f4bf0d6c53cf5503140e51caa92eb5d0000000000000000000000000000000000000000000000000000000069a187311708497c3b281c373f4e5b08cceedcbfb1dc220749fb9bbc74d83d8189ff45fe00000000000000000000000000000000000000000000000000000000000001400000000000000000000000000000000000000000000000000000000000000260000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000004c0000000000000000000000000e6a74e08eff5df62efb601ec04eaf764471da79700000000000000000000000000000000000000000000000000000000000000c000000000000000000000000042000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000067c054290000000000000000000000000000000000000000000000000000000000000000c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a4700000000000000000000000000000000000000000000000000000000000000001304d84c3d9a7be3b28c94531833589fcd6edb6e08f4c7c32d4f71b54bda029130000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000d1da1f965a95642959f72d6aac7502f003c4cff400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000016427c777a9000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000c05dd4ceae21111aef8333129c43ddac5129947a3d9fc6e04578e995d6d680ea150000000000000000000000000000000000000000000000000000000069a18731304d84c3d9a7be3b28c94531833589fcd6edb6e08f4c7c32d4f71b54bda029130000000000000000000000000000000000000000000000000000000000000003000000000000000000000000e6a74e08eff5df62efb601ec04eaf764471da797000000000000000000000000000000000000000000000000000000000000004126d48cc86c2f74484ba1dbeaa09bb148ccd2b830de70f2ad532350f6ffec1a462ebd264d3c6ce9476e4615739f4defae93d7d2e03419edaa52867e80160f85bf1c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000552483da3a338895199e5e538530213157e931bf0697e90c5de6a7b6312321bce8bf463a7a1aab87cca40e6672309b0af28906c2b35e7120838caa943a64c8826e32f7e22b4f64794f48194fd6f8f52852f78a1dcb1b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000414c77c629f6ce83f080adb322a474e874c29492075f2f1039ad46fe67a902f54d05c3b70d7e499ead6daa219154c48157f5257286628d2cbe8bfbbbdd8bda822d1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000008b7f8f3a00cde57c9c118c3edeadac5275c945b20000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000a")
        })
    })
})
